<!DOCTYPE html><html><head><title>Two-Factor Authentication with Authy</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Two-Factor Authentication with Authy"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Two-Factor Authentication with Authy</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement two-factor authentication (2FA) in your web app with Twilio-powered Authy. 2FA helps further secure your users' data by validating more than just a password. This tutorial will show you the code to make it happen.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="How It Works" data-file="app/User.php" data-highlight="" class="step"><h2 id="about-this-application">About this application</h2>
<p>This <a href="//php.net/">PHP</a> <a href="//laravel.com/">Laravel</a> sample application is an
example of typical login flow. To run this sample
app yourself, <a href="//github.com/TwilioDevEd/authy2fa-laravel">download the code and follow the instructions on
GitHub</a>.</p>
<p>Adding two-factor authentication (2FA) to your web application increases the
security of your user&#39;s data. <a href="//en.wikipedia.org/wiki/Multi-factor_authentication">Multi-factor authentication</a>
determines the identity of a user by validating once by logging into the app,
and then by validating their mobile device.</p>
<p>For the second factor, we will validate that the user has their mobile phone by either:</p>
<ul>
<li>Sending them a OneTouch push notification to their mobile Authy app or</li>
<li>Sending them a token through their mobile Authy app or</li>
<li>Sending them a one-time token in a text message <a href="//www.authy.com/">sent with Authy via Twilio</a>. Here&#39;s how this works at a high level:</li>
</ul>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-high-level.png" alt="2FA High Level"></p>
<p>Let&#39;s get started! Click the right arrow above to move to the next step
  of the tutorial.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//laravel.com/docs/5.1">Getting Started with Laravel</a></li>
<li><a href="//github.com/authy/authy-php">PHP Client for Authy</a></li>
<li><a href="//laravel.com/docs/5.1/authentication#authentication-quickstart">Laravel Basic Authentication</a></li>
</ul>
</div><div data-file=".env.example" data-highlight="10" class="step"><h2 id="configuring-authy">Configuring Authy</h2>
<p>If you haven&#39;t configured Authy already now is the time to <a href="//dashboard.authy.com/signup">sign up for Authy</a>.
Create your first application naming it as you wish. After you create your application,
your &quot;production&quot; API key will be visible on your <a href="//dashboard.authy.com">dashboard</a>:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-authy-dashboard.png" alt="Authy Dashboard"></p>
<p>Once we have an Authy API key we register it as a environment variable.</p>
<p>Let&#39;s take a look at how we register a user with Authy.</p>
<hr>
<p>  <strong>See Also:</strong></p>
<ul>
<li><a href="//laravel.com/docs/5.0/configuration#environment-configuration">Managing Environment Variables in Laravel</a></li>
<li><a href="//stackoverflow.com/questions/61747/installing-pdo-drivers-for-postgresql-on-mac-using-zend-for-eclipse#answer-1286153">StackOverflow: Installing the Postgres driver for Mac</a></li>
<li><a href="//github.com/barryvdh/laravel-debugbar">Better debugging for Laravel</a></li>
</ul>
</div><div data-file="app/User.php" data-highlight="67-83" class="step"><h2 id="registering-a-user-with-authy">Registering a User with Authy</h2>
<p>When a new user <em>signs up</em> for our website, we will call this route. This
will save our new user to the database and will register the user
with Authy.</p>
<p>In order to set up your application, Authy only needs the user&#39;s <em>email</em>,
<em>phone number</em> and <em>country code</em>. In order to do a <em>two-factor authentication</em>,
we need to make sure we ask for this information at sign up.</p>
<p>Once we register the User with Authy we get an <strong>authy id</strong> back. This is
very important since it&#39;s how we will verify the identity of our User with
Authy.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//docs.authy.com/#section-Enabling_two-
factor_on_a_user">Enabling a User with Authy</a></li>
<li><a href="//laravel.com/docs/5.1/eloquent">Getting started with Eloquent ORM</a></li>
</ul>
</div><div data-file="app/Http/Controllers/Auth/AuthController.php" data-highlight="43-56" class="step"><h2 id="logging-in-with-authy-onetouch">Logging in with Authy OneTouch</h2>
<p>When a User attempts to log in to our website, we will ask them for a second
form of identification. Let&#39;s take a look at Authy&#39;s OneTouch verification first.</p>
<p><img src="//howtodocs.s3.amazonaws.com/onetouch-approved.gif" alt="Authy OneTouch Approval"></p>
<p>OneTouch works like this:</p>
<ul>
<li>We attempt to send a User a <em>OneTouch Approval Request</em>.</li>
<li>If the User has OneTouch enabled we will get a <em>success</em> message back.</li>
<li>The User hits <strong>Approve</strong> in their Authy app.</li>
<li>Authy makes a POST request to our app with an <em>approved</em> status.</li>
<li>We log the User in.</li>
</ul>
<p>In the next steps we&#39;ll look at how we handle cases where the User does not
have OneTouch, or denies the login request.</p>
</div><div data-file="app/User.php" data-highlight="85-113" class="step"><h2 id="sending-the-onetouch-request">Sending the OneTouch Request</h2>
<p>When our User logs in we immediately attempt to verify their identity with
OneTouch. We will fallback gracefully if they don&#39;t have a OneTouch device,
but we won&#39;t know until we try.</p>
<p>Authy allows us to input details with our OneTouch request, including a message,
a logo and so on. We could easily send any amount of details by appending
<code>details[&#39;some_detail&#39;]</code>. You could imagine a scenario where we send a
OneTouch request to approve a money transfer.</p>
<pre><code class="cm-s-monokai lang-php">$params = array(
  &#39;message&#39; =&gt; &quot;Request to send money to Jarod&#39;s vault&quot;,
  &#39;details[From]&#39; =&gt; &quot;Jarod&quot;,
  &#39;details[Amount]&#39; =&gt; &quot;1,000,000&quot;,
  &#39;details[Currency]&#39; =&gt; &quot;Galleons&quot;,
)
</code></pre>
<p>Once we send the request we need to update our User&#39;s <code>authy_status</code> based
on the response.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//docs.authy.com/new_doc/authy_onetouch_api#create-an-approval-request-to-be-sent-to-user">Create Approval Requests with Authy</a></li>
<li><a href="//docs.authy.com/new_doc/authy_onetouch_api#getting-approval-request-info">Getting Approval Request info</a></li>
</ul>
</div><div data-file="app/Http/Controllers/Auth/AuthyController.php" data-highlight="31-42" class="step"><h2 id="configuring-the-onetouch-callback">Configuring the OneTouch callback</h2>
<p>In order for our app to know what the <em>user</em> did after we sent the
OneTouch request, we need to register a callback endpoint with Authy.</p>
<p><img src="//howtodocs.s3.amazonaws.com/onetouch-callback-endpoint.png" alt="Authy OneTouch Callback"></p>
<p>Here in our callback, we look up the <em>user</em> using the <code>authy_id</code> sent with the Authy POST request. Ideally at this point we would probably use a websocket to let our client know that we received a response from Authy.
However for this version we&#39;re going to keep it simple and just update the
<code>authy_status</code> on the User.</p>
<p>Let&#39;s take a look at the client-side code that will be handling this.</p>
</div><div data-file="public/js/sessions.js" class="step"><h2 id="handling-two-factor-in-the-browser">Handling Two-Factor in the Browser</h2>
<p>We&#39;ve already taken a look at what&#39;s happening on the server side, so let&#39;s
step in front of the cameras and see how our JavaScript is interacting
with those server endpoints.</p>
<p>When we expect a OneTouch response, we will begin by polling <code>/authy/status</code>
until we see an Authy status is not empty. Let&#39;s take a look at this controller
and see what is happening.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//api.jquery.com/jquery.post/">jQuery Post method</a></li>
<li><a href="//getbootstrap.com/javascript/#modals">Bootstrap modals</a></li>
</ul>
</div><div data-file="app/Http/Controllers/Auth/AuthyController.php" data-highlight="21-29" class="step"><h2 id="finishing-the-2fa-step">Finishing the 2FA Step</h2>
<p>If <code>authy_status</code> is <em>approved</em> the user will be redirected to the
protected content, otherwise we&#39;ll show the login form with a message that indicates
the request was <em>denied</em>.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//laravel.com/docs/5.1/responses#json-responses">Laravel: JSON Responses</a></li>
</ul>
</div><div class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! We&#39;ve just implemented two-factor auth using three different methods and the latest in Authy technology.</p>
<p>If you&#39;re a PHP developer working with Twilio, you might want to
check out these other tutorials.</p>
<p><a href="//www.twilio.com/docs/howto/walkthrough/call-tracking/php/laravel"><strong>Call Tracking</strong></a></p>
<p>Measure the effectiveness of different marketing campaigns with unique phone numbers.</p>
<p><a href="//www.twilio.com/docs/howto/walkthrough/server-notifications/php/laravel"><strong>Server
Notifications via SMS</strong></a></p>
<p>Faster than e-mail and less likely to get blocked, text messages are great
for timely alerts and notifications. Learn how to send out SMS (and MMS)
notifications to a list of server administrators.</p>
<h3 id="did-this-help-">Did this help?</h3>
<p>Thanks for checking this tutorial out! If you have any feedback
to share with us, we&#39;d love to hear it.
<a href="mailto:deved-oss@twilio.com">Contact the Twilio Developer Education Team</a>
to let us know what you think.</p>
</div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="app/User.php" data-mode="php">PD9waHAgbmFtZXNwYWNlIEFwcDsKCnVzZSBBdXRoeVxBdXRoeUFwaSBhcyBBdXRoeUFwaTsKdXNlIElsbHVtaW5hdGVcQXV0aFxBdXRoZW50aWNhdGFibGU7CnVzZSBJbGx1bWluYXRlXEF1dGhcUGFzc3dvcmRzXENhblJlc2V0UGFzc3dvcmQ7CnVzZSBJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXEF1dGhlbnRpY2F0YWJsZSBhcyBBdXRoZW50aWNhdGFibGVDb250cmFjdDsKdXNlIElsbHVtaW5hdGVcQ29udHJhY3RzXEF1dGhcQ2FuUmVzZXRQYXNzd29yZCBhcyBDYW5SZXNldFBhc3N3b3JkQ29udHJhY3Q7CnVzZSBJbGx1bWluYXRlXERhdGFiYXNlXEVsb3F1ZW50XE1vZGVsOwoKY2xhc3MgVXNlciBleHRlbmRzIE1vZGVsIGltcGxlbWVudHMgQXV0aGVudGljYXRhYmxlQ29udHJhY3QsIENhblJlc2V0UGFzc3dvcmRDb250cmFjdAp7CgogICAgdXNlIEF1dGhlbnRpY2F0YWJsZSwgQ2FuUmVzZXRQYXNzd29yZDsKCiAgICAvKioKICAgICAqIFRoZSBkYXRhYmFzZSB0YWJsZSB1c2VkIGJ5IHRoZSBtb2RlbC4KICAgICAqCiAgICAgKiBAdmFyIHN0cmluZwogICAgICovCiAgICBwcm90ZWN0ZWQgJHRhYmxlID0gJ3VzZXJzJzsKCiAgICAvKioKICAgICAqIFRoZSBhdHRyaWJ1dGVzIHRoYXQgYXJlIG1hc3MgYXNzaWduYWJsZS4KICAgICAqCiAgICAgKiBAdmFyIGFycmF5CiAgICAgKi8KICAgIHByb3RlY3RlZCAkZmlsbGFibGUgPSBbJ25hbWUnLCAnZW1haWwnLCAncGFzc3dvcmQnLCAncGhvbmVfbnVtYmVyJywgJ2NvdW50cnlfY29kZSddOwoKICAgIC8qKgogICAgICogVGhlIGF0dHJpYnV0ZXMgZXhjbHVkZWQgZnJvbSB0aGUgbW9kZWwncyBKU09OIGZvcm0uCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcm90ZWN0ZWQgJGhpZGRlbiA9IFsncGFzc3dvcmQnLCAncmVtZW1iZXJfdG9rZW4nLCAnYXV0aHlfc3RhdHVzJywgJ2F1dGh5X2lkJ107CgogICAgLyoqCiAgICAgKiBBdXRoeSBBcGkgS2V5CiAgICAgKiBAdmFyIFN0cmluZwogICAgICovCiAgICBwcml2YXRlICRfYXV0aHlfYXBpX2tleTsKCiAgICAvKioKICAgICAqIEF1dGh5IEFwaSBDbGllbnQKICAgICAqIEB2YXIgU3RyaW5nCiAgICAgKi8KICAgIHByaXZhdGUgJF9hdXRoeV9hcGk7CgogICAgcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEF1dGh5QXBpS2V5KCkKICAgIHsKICAgICAgICBpZiAoZW1wdHkoJHRoaXMtPl9hdXRoeV9hcGlfa2V5KSkgewogICAgICAgICAgICAkdGhpcy0+X2F1dGh5X2FwaV9rZXkgPSBnZXRlbnYoJ0FVVEhZX0FQSV9LRVknKSBvciBkaWUoCiAgICAgICAgICAgICJZb3UgbXVzdCBzcGVjaWZ5IHlvdXIgYXBpIGtleS4gVmlzaXQgaHR0cHM6Ly9kYXNoYm9hcmQuYXV0aHkuY29tLyIKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICR0aGlzLT5fYXV0aHlfYXBpX2tleTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0QXV0aHlBcGkoKQogICAgewogICAgICAgIGlmIChlbXB0eSgkdGhpcy0+X2F1dGh5X2FwaSkpIHsKICAgICAgICAgICAgJHRoaXMtPl9hdXRoeV9hcGkgPSBuZXcgQXV0aHlBcGkoJHRoaXMtPmdldEF1dGh5QXBpS2V5KCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJHRoaXMtPl9hdXRoeV9hcGk7CiAgICB9CgoKICAgIHB1YmxpYyBmdW5jdGlvbiByZWdpc3Rlcl9hdXRoeSgpCiAgICB7CiAgICAgICAgJHVzZXIgPSAkdGhpcy0+Z2V0QXV0aHlBcGkoKS0+cmVnaXN0ZXJVc2VyKAogICAgICAgICAgICAkdGhpcy0+ZW1haWwsCiAgICAgICAgICAgICR0aGlzLT5waG9uZV9udW1iZXIsCiAgICAgICAgICAgICR0aGlzLT5jb3VudHJ5X2NvZGUKICAgICAgICApOyAvL2VtYWlsLCBjZWxscGhvbmUsIGNvdW50cnlfY29kZQoKICAgICAgICBpZiAoJHVzZXItPm9rKCkpIHsKICAgICAgICAgICAgJHRoaXMtPmF1dGh5X2lkID0gJHVzZXItPmlkKCk7CiAgICAgICAgICAgICR0aGlzLT5zYXZlKCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNlbmRPbmVUb3VjaCgkbWVzc2FnZSkKICAgIHsKICAgICAgICAvLyByZXNldCBvbmVUb3VjaCBzdGF0dXMKICAgICAgICBpZiAoJHRoaXMtPmF1dGh5X3N0YXR1cyAhPSAndW52ZXJpZmllZCcpIHsKICAgICAgICAgICAgJHRoaXMtPmF1dGh5X3N0YXR1cyA9ICd1bnZlcmlmaWVkJzsKICAgICAgICAgICAgJHRoaXMtPnNhdmUoKTsKICAgICAgICB9CgogICAgICAgICRwYXJhbXMgPSBhcnJheSgKICAgICAgICAgICAgJ2FwaV9rZXknID0+ICR0aGlzLT5nZXRBdXRoeUFwaUtleSgpLAogICAgICAgICAgICAnbWVzc2FnZScgPT4gJG1lc3NhZ2UsCiAgICAgICAgICAgICdkZXRhaWxzW0VtYWlsXScgPT4gJHRoaXMtPmVtYWlsLAogICAgICAgICk7CgogICAgICAgICRkZWZhdWx0cyA9IGFycmF5KAogICAgICAgICAgICBDVVJMT1BUX1VSTCA9PiAiaHR0cHM6Ly9hcGkuYXV0aHkuY29tIiAuCiAgICAgICAgICAgICAgICAiL29uZXRvdWNoL2pzb24vdXNlcnMveyR0aGlzLT5hdXRoeV9pZH0vYXBwcm92YWxfcmVxdWVzdHMiLAogICAgICAgICAgICBDVVJMT1BUX1BPU1QgPT4gdHJ1ZSwKICAgICAgICAgICAgQ1VSTE9QVF9QT1NURklFTERTID0+ICRwYXJhbXMsCiAgICAgICAgKTsKCiAgICAgICAgJGNoID0gY3VybF9pbml0KCk7CiAgICAgICAgY3VybF9zZXRvcHRfYXJyYXkoJGNoLCAkZGVmYXVsdHMpOwogICAgICAgICRvdXRwdXQgPSBjdXJsX2V4ZWMoJGNoKTsKICAgICAgICBjdXJsX2Nsb3NlKCRjaCk7CiAgICAgICAgJGpzb24gPSBqc29uX2RlY29kZSgkb3V0cHV0KTsKCiAgICAgICAgcmV0dXJuICRqc29uOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZW5kVG9rZW4oKQogICAgewogICAgICAgICRzbXMgPSAkdGhpcy0+Z2V0QXV0aHlBcGkoKS0+cmVxdWVzdFNtcygkdGhpcy0+YXV0aHlfaWQpOwoKICAgICAgICByZXR1cm4gJHNtcy0+b2soKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZ5VG9rZW4oJHRva2VuKQogICAgewogICAgICAgICR2ZXJpZmljYXRpb24gPSAkdGhpcy0+Z2V0QXV0aHlBcGkoKS0+dmVyaWZ5VG9rZW4oJHRoaXMtPmF1dGh5X2lkLCAkdG9rZW4pOwoKICAgICAgICBpZiAoJHZlcmlmaWNhdGlvbi0+b2soKSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9Cg==</textarea>
<textarea class="saurus-file" data-file=".env.example" data-mode="text">QVBQX0VOVj1sb2NhbApBUFBfREVCVUc9dHJ1ZQpBUFBfS0VZPXVmeGhaaVFjS3hpMWVIVm1HcThNd2ZBY1JnWkhKMVFxCgpEQl9IT1NUPWxvY2FsaG9zdApEQl9EQVRBQkFTRT1hdXRoeV9sYXJhdmVsCkRCX1VTRVJOQU1FPXlvdXJfZGJfdXNlcm5hbWUKREJfUEFTU1dPUkQ9eW91cl9kYl9wYXNzd29yZAoKQVVUSFlfQVBJX0tFWT15b3VyX3Rva2VuCg==</textarea>
<textarea class="saurus-file" data-file="app/Http/Controllers/Auth/AuthController.php" data-mode="php">PD9waHAgbmFtZXNwYWNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXEF1dGg7Cgp1c2UgQXV0aDsKdXNlIFNlc3Npb247CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIElsbHVtaW5hdGVcQ29udHJhY3RzXEF1dGhcR3VhcmQ7CnVzZSBJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXFJlZ2lzdHJhcjsKdXNlIElsbHVtaW5hdGVcRm91bmRhdGlvblxBdXRoXEF1dGhlbnRpY2F0ZXNBbmRSZWdpc3RlcnNVc2VyczsKCgpjbGFzcyBBdXRoQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIgewoKICAvKgogIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIHwgUmVnaXN0cmF0aW9uICYgTG9naW4gQ29udHJvbGxlcgogIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogIHwKICB8IFRoaXMgY29udHJvbGxlciBoYW5kbGVzIHRoZSByZWdpc3RyYXRpb24gb2YgbmV3IHVzZXJzLCBhcyB3ZWxsIGFzIHRoZQogIHwgYXV0aGVudGljYXRpb24gb2YgZXhpc3RpbmcgdXNlcnMuIEJ5IGRlZmF1bHQsIHRoaXMgY29udHJvbGxlciB1c2VzCiAgfCBhIHNpbXBsZSB0cmFpdCB0byBhZGQgdGhlc2UgYmVoYXZpb3JzLiBXaHkgZG9uJ3QgeW91IGV4cGxvcmUgaXQ/CiAgfAogICovCgogIHVzZSBBdXRoZW50aWNhdGVzQW5kUmVnaXN0ZXJzVXNlcnM7CgogIC8qKgogICAqIENyZWF0ZSBhIG5ldyBhdXRoZW50aWNhdGlvbiBjb250cm9sbGVyIGluc3RhbmNlLgogICAqCiAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxDb250cmFjdHNcQXV0aFxHdWFyZCAgJGF1dGgKICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXENvbnRyYWN0c1xBdXRoXFJlZ2lzdHJhciAgJHJlZ2lzdHJhcgogICAqIEByZXR1cm4gdm9pZAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdChHdWFyZCAkYXV0aCwgUmVnaXN0cmFyICRyZWdpc3RyYXIpCiAgewogICAgJHRoaXMtPmF1dGggPSAkYXV0aDsKICAgICR0aGlzLT5yZWdpc3RyYXIgPSAkcmVnaXN0cmFyOwoKICAgICR0aGlzLT5taWRkbGV3YXJlKCdndWVzdCcsIFsnZXhjZXB0JyA9PiAnZ2V0TG9nb3V0J10pOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHBvc3RMb2dpbihSZXF1ZXN0ICRyZXF1ZXN0KSB7CiAgICAkY3JlZGVudGlhbHMgPSAkcmVxdWVzdC0+b25seSgnZW1haWwnLCdwYXNzd29yZCcpOwogICAgaWYoQXV0aDo6dmFsaWRhdGUoJGNyZWRlbnRpYWxzKSkgewogICAgICAkdXNlciA9IFVzZXI6OndoZXJlKCdlbWFpbCcsICc9JywgJHJlcXVlc3QtPmlucHV0KCdlbWFpbCcpKS0+Zmlyc3RPckZhaWwoKTsgCiAgICAgICRzdGF0dXMgPSAkdXNlci0+c2VuZE9uZVRvdWNoKCdSZXF1ZXN0IHRvIExvZ2luIHRvIFR3aWxpbyBkZW1vIGFwcCcpOwogICAgICBTZXNzaW9uOjpzZXQoJ3Bhc3N3b3JkX3ZhbGlkYXRlZCcsIHRydWUpOwogICAgICBTZXNzaW9uOjpzZXQoJ2lkJywgJHVzZXItPmlkKTsKICAgICAgcmV0dXJuIHJlc3BvbnNlKCRzdGF0dXMpOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcmVkaXJlY3QoJy9hdXRoL2xvZ2luJyktPndpdGhFcnJvcnMoWwogICAgICAgICAgICAnZW1haWwnID0+ICdUaGUgZW1haWwgYW5kIHBhc3N3b3JkIGNvbWJpbmF0aW9uIHlvdSBlbnRlcmVkIGlzIGluY29ycmVjdC4nLAogICAgICAgIF0pOwogICAgfQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldFR3b2ZhY3RvcigpIHsKICAgIHJldHVybiB2aWV3KCdhdXRoL3R3b2ZhY3RvcicpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHBvc3RUd29mYWN0b3IoUmVxdWVzdCAkcmVxdWVzdCkgewogICAgaWYoIVNlc3Npb246OmdldCgncGFzc3dvcmRfdmFsaWRhdGVkJykgfHwgIVNlc3Npb246OmdldCgnaWQnKSkgewogICAgICByZXR1cm4gcmVkaXJlY3QoJy9hdXRoL2xvZ2luJyk7CiAgICB9CgogICAgaWYoaXNzZXQoJF9QT1NUWyd0b2tlbiddKSkgewogICAgICR1c2VyID0gVXNlcjo6ZmluZChTZXNzaW9uOjpnZXQoJ2lkJykpOwogICAgIGlmKCR1c2VyLT52ZXJpZnlUb2tlbigkcmVxdWVzdC0+aW5wdXQoJ3Rva2VuJykpKSB7CiAgICAgICBBdXRoOjpsb2dpbigkdXNlcik7CiAgICAgICByZXR1cm4gcmVkaXJlY3QoKS0+aW50ZW5kZWQoJy9ob21lJyk7CiAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcmVkaXJlY3QoJy9hdXRoL3R3b2ZhY3RvcicpLT53aXRoRXJyb3JzKFsKICAgICAgICAgICAgJ3Rva2VuJyA9PiAnVGhlIHRva2VuIHlvdSBlbnRlcmVkIGlzIGluY29ycmVjdCcsCiAgICAgICAgXSk7CiAgICAgfQogICAgfQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHBvc3RSZWdpc3RlcihSZXF1ZXN0ICRyZXF1ZXN0KQogIHsKICAgICR2YWxpZGF0b3IgPSAkdGhpcy0+cmVnaXN0cmFyLT52YWxpZGF0b3IoJHJlcXVlc3QtPmFsbCgpKTsKICAgIGlmICgkdmFsaWRhdG9yLT5mYWlscygpKQogICAgewogICAgICAkdGhpcy0+dGhyb3dWYWxpZGF0aW9uRXhjZXB0aW9uKAogICAgICAgICRyZXF1ZXN0LCAkdmFsaWRhdG9yCiAgICAgICk7CiAgICB9CiAgICAkdXNlciA9ICR0aGlzLT5yZWdpc3RyYXItPmNyZWF0ZSgkcmVxdWVzdC0+YWxsKCkpOwogICAgJHVzZXItPnJlZ2lzdGVyX2F1dGh5KCk7CiAgICAkdXNlci0+c2VuZFRva2VuKCk7CiAgICBTZXNzaW9uOjpzZXQoJ3Bhc3N3b3JkX3ZhbGlkYXRlZCcsIHRydWUpOwogICAgU2Vzc2lvbjo6c2V0KCdpZCcsICR1c2VyLT5pZCk7CiAgICByZXR1cm4gcmVkaXJlY3QoJy9hdXRoL3R3b2ZhY3RvcicpOwogIH0KCn0K</textarea>
<textarea class="saurus-file" data-file="app/Http/Controllers/Auth/AuthyController.php" data-mode="php">PD9waHAgbmFtZXNwYWNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXEF1dGg7Cgp1c2UgQXV0aDsKdXNlIFNlc3Npb247CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxIdHRwXFJlcXVlc3RzOwoKY2xhc3MgQXV0aHlDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlciB7CiAgICAvKioKICAgICogQ3JlYXRlIGEgbmV3IGNvbnRyb2xsZXIgaW5zdGFuY2UuCiAgICAqCiAgICAqIEByZXR1cm4gdm9pZAogICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpCiAgICB7CiAgICAgICAgJHRoaXMtPm1pZGRsZXdhcmUoJ2d1ZXN0Jyk7CiAgICB9CgogICAgLy8gQ2hlY2sgc3RhdHVzIG9mIHVzZXIKICAgIHB1YmxpYyBmdW5jdGlvbiBzdGF0dXMoUmVxdWVzdCAkcmVxdWVzdCkgewogICAgICAgICR1c2VyID0gVXNlcjo6ZmluZChTZXNzaW9uOjpnZXQoJ2lkJykpOwogICAgICAgICRzdGF0dXMgPSAkdXNlci0+YXV0aHlfc3RhdHVzOwogICAgICAgIGlmKCRzdGF0dXMgPT0gJ2FwcHJvdmVkJykgewogICAgICAgICAgICBBdXRoOjpsb2dpbigkdXNlcik7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsnc3RhdHVzJyA9PiAkc3RhdHVzLCAncmVzcG9uc2UnID0+IFNlc3Npb246OmdldCgncmVxdWVzdCcpXSk7CiAgICB9CgogICAgLy8gUHVibGljIHdlYmhvb2sgZm9yIEF1dGh5CiAgICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2soUmVxdWVzdCAkcmVxdWVzdCkgewogICAgICAgICRhdXRoeV9pZCA9ICRyZXF1ZXN0LT5pbnB1dCgnYXV0aHlfaWQnKTsKICAgICAgICAkdXNlciA9IFVzZXI6OndoZXJlKCdhdXRoeV9pZCcsICc9JywgJGF1dGh5X2lkKS0+Zmlyc3RPckZhaWwoKTsKICAgICAgICBpZihpc3NldCgkdXNlcikpIHsKICAgICAgICAgICAgJHVzZXItPmF1dGh5X3N0YXR1cyA9ICRyZXF1ZXN0LT5pbnB1dCgnc3RhdHVzJyk7CiAgICAgICAgICAgICR1c2VyLT5zYXZlKCk7CiAgICAgICAgICAgIHJldHVybiAib2siOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAiaW52YWxpZCI7CiAgICAgICAgfQogICAgfQoKfQo=</textarea>
<textarea class="saurus-file" data-file="public/js/sessions.js" data-mode="javascript">JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7CiAgY29uc29sZS5sb2coJ2xvYWRlZCcpOwogICQoJyNsb2dpbi1mb3JtJykuc3VibWl0KGZ1bmN0aW9uKGUpIHsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIGZvcm1EYXRhID0gJChlLmN1cnJlbnRUYXJnZXQpLnNlcmlhbGl6ZSgpOwogICAgYXR0ZW1wdE9uZVRvdWNoVmVyaWZpY2F0aW9uKGZvcm1EYXRhKTsKICB9KQoKICB2YXIgYXR0ZW1wdE9uZVRvdWNoVmVyaWZpY2F0aW9uID0gZnVuY3Rpb24oZm9ybSkgewogICAgJC5wb3N0KCAiL2F1dGgvbG9naW4iLCBmb3JtLCBmdW5jdGlvbihkYXRhKSB7CiAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShkYXRhLnJlcGxhY2UoLzEvZywgIiIpKTsKICAgICAgJCgnI2F1dGh5LW1vZGFsJykubW9kYWwoe2JhY2tkcm9wOidzdGF0aWMnfSwnc2hvdycpOwogICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgJCgnLmF1dGgtb3QnKS5mYWRlSW4oKQogICAgICAgIGNoZWNrRm9yT25lVG91Y2goKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkKCcuYXV0aC10b2tlbicpLmZhZGVJbigpCiAgICAgIH0KICAgIH0pOwogIH07CgogIHZhciBjaGVja0Zvck9uZVRvdWNoID0gZnVuY3Rpb24oKSB7CiAgICAkLmdldCggIi9hdXRoeS9zdGF0dXMiLCBmdW5jdGlvbihkYXRhKSB7CiAgICAgIAogICAgICBpZiAoZGF0YS5zdGF0dXMgPT0gJ2FwcHJvdmVkJykgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gIi9ob21lIjsKICAgICAgfSBlbHNlIGlmIChkYXRhLnN0YXR1cyA9PSAnZGVuaWVkJykgewogICAgICAgIHNob3dUb2tlbkZvcm0oKTsKICAgICAgICB0cmlnZ2VyU01TVG9rZW4oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZXRUaW1lb3V0KGNoZWNrRm9yT25lVG91Y2gsIDIwMDApOwogICAgICB9CiAgICB9KQogIH07CgogIHZhciBzaG93VG9rZW5Gb3JtID0gZnVuY3Rpb24oKSB7CiAgICAkKCcuYXV0aC1vdCcpLmZhZGVPdXQoZnVuY3Rpb24oKSB7CiAgICAgICQoJy5hdXRoLXRva2VuJykuZmFkZUluKCdzbG93JykKICAgIH0pCiAgfTsKCiAgdmFyIHRyaWdnZXJTTVNUb2tlbiA9IGZ1bmN0aW9uKCkgewogICAgJC5nZXQoIi9hdXRoeS9zZW5kX3Rva2VuIikKICB9Owp9KQoK</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/authy2fa-laravel" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>